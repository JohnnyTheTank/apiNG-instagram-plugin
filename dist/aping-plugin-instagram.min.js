
/*! aping-plugin-instagram 15-11-2015 */
"use strict";var jjtApingInstagram=angular.module("jtt_aping_instagram",["jtt_instagram"]).directive("apingInstagram",["instagramFactory","apingApiKeys","apingInstagramHelper","apingUtilityHelper",function(a,b,c,d){return{require:"?aping",restrict:"A",replace:"false",link:function(e,f,g,h){var i="instagram",j=h.getAppSettings(),k=d.parseJsonFromAttributes(g.apingInstagram,i);k.forEach(function(d){var e={access_token:b.instagram,client_id:b.instagramClientId,count:d.items||j.items};d.userId?(e.userId=d.userId,a.getPostsFromUserById(e).success(function(a){h.concatToResults(c.getObjectByJsonData(a,j.type))}).error(function(a){})):d.tag&&(e.tag=d.tag,a.getPostsByTag(e).success(function(a){h.concatToResults(c.getObjectByJsonData(a,j.type))}).error(function(a){}))})}}}]);jjtApingInstagram.service("apingInstagramHelper",["apingOutputObjects","apingTimeHelper","apingUtilityHelper",function(a,b,c){this.getObjectByJsonData=function(a,b){var c=[];if(a){var d=this;a.data&&angular.forEach(a.data,function(a,e){var f=d.getItemByJsonData(a,b);f&&c.push(f)})}return c},this.getItemByJsonData=function(a,b){var c={};if(a&&b)switch(b){case"social":c=this.getSocialItemByJsonData(a);break;case"video":c=this.getVideoItemByJsonData(a);break;case"image":c=this.getImageItemByJsonData(a)}return c},this.getSocialItemByJsonData=function(c){var d=a.getNew("social","instagram");switch($.extend(!0,d,{blog_name:c.user.full_name?c.user.full_name+" (@"+c.user.username+")":"@"+c.user.username,blog_id:"@"+c.user.username,blog_link:"https://instagram.com/"+c.user.username,intern_type:c.type,timestamp:1e3*parseInt(c.created_time),post_url:c.link,intern_id:c.id,text:c.caption?c.caption.text:!1,tags:c.tags,date:b.getConvertedTimestamp(c.created_time),likes:c.likes?c.likes.count:!1,comments:c.comments?c.likes.comments:!1}),d.text=this.replaceHashtagWithoutSpaces(d.text),c.type){case"image":d.type="image";break;case"video":d.type="video",d.source=c.videos.standard_resolution.url}return d.img_url=c.images.standard_resolution.url,d},this.getVideoItemByJsonData=function(c){if("video"!=c.type)return!1;var d=a.getNew("video","instagram");return $.extend(!0,d,{blog_name:c.user.full_name?c.user.full_name+" (@"+c.user.username+")":"@"+c.user.username,blog_id:"@"+c.user.username,blog_link:"https://instagram.com/"+c.user.username,intern_type:c.type,timestamp:1e3*parseInt(c.created_time),post_url:c.link,intern_id:c.id,text:c.caption?c.caption.text:!1,tags:c.tags,date:b.getConvertedTimestamp(c.created_time),likes:c.likes?c.likes.count:!1,comments:c.comments?c.likes.comments:!1,type:"video",source:c.videos.standard_resolution?c.videos.standard_resolution.url:!1}),d.text=this.replaceHashtagWithoutSpaces(d.text),d.img_url=c.images.standard_resolution.url,d},this.getImageItemByJsonData=function(c){if("image"!=c.type)return!1;var d=a.getNew("image","instagram");return $.extend(!0,d,{blog_name:c.user.full_name?c.user.full_name+" (@"+c.user.username+")":"@"+c.user.username,blog_id:"@"+c.user.username,blog_link:"https://instagram.com/"+c.user.username,intern_type:c.type,timestamp:1e3*parseInt(c.created_time),post_url:c.link,intern_id:c.id,text:c.caption?c.caption.text:!1,tags:c.tags,date:b.getConvertedTimestamp(c.created_time),likes:c.likes?c.likes.count:!1,comments:c.comments?c.likes.comments:!1,type:"image"}),d.text=this.replaceHashtagWithoutSpaces(d.text),d.img_url=c.images.standard_resolution.url,d},this.replaceHashtagWithoutSpaces=function(a){return a&&"string"===$.type(a)&&(a=a.replace(/#/g," #"),a=a.replace(/  #/g," #")),a}}]);