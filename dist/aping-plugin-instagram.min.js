
/*! aping-plugin-instagram v0.3.2 (09-12-2015) by Jonathan Hornung */
"use strict";var jjtApingInstagram=angular.module("jtt_aping_instagram",["jtt_instagram"]).directive("apingInstagram",["instagramFactory","apingInstagramHelper","apingUtilityHelper",function(a,b,c){return{require:"?aping",restrict:"A",replace:"false",link:function(d,e,f,g){var h=g.getAppSettings(),i=c.parseJsonFromAttributes(f.apingInstagram,b.getThisPlattformString(),h);i.forEach(function(d){var e={access_token:c.getApiCredentials(b.getThisPlattformString(),"access_token"),count:d.items||h.items};d.userId?(e.userId=d.userId,a.getMediaFromUserById(e).success(function(a){g.concatToResults(b.getObjectByJsonData(a,h.model))}).error(function(a){})):d.tag?(e.tag=d.tag,a.getMediaByTag(e).success(function(a){g.concatToResults(b.getObjectByJsonData(a,h.model))}).error(function(a){})):d.locationId?(e.locationId=d.locationId,a.getMediaFromLocationById(e).success(function(a){g.concatToResults(b.getObjectByJsonData(a,h.model))}).error(function(a){})):d.lat&&d.lng&&(e.lat=d.lat,e.lng=d.lng,d.distance&&(e.distance=d.distance),a.getMediaByCoordinates(e).success(function(a){g.concatToResults(b.getObjectByJsonData(a,h.model))}).error(function(a){}))})}}}]);jjtApingInstagram.service("apingInstagramHelper",["apingModels","apingTimeHelper","apingUtilityHelper",function(a,b,c){this.getThisPlattformString=function(){return"instagram"},this.getThisPlattformLink=function(){return"https://instagram.com/"},this.getObjectByJsonData=function(a,b){var c=[];if(a){var d=this;a.data&&angular.forEach(a.data,function(a,e){var f=d.getItemByJsonData(a,b);if(f){var g=d.getItemByJsonData(a,b);g&&c.push(g)}})}return c},this.getItemByJsonData=function(a,b){var c={};if(a&&b)switch(b){case"social":c=this.getSocialItemByJsonData(a);break;case"video":c=this.getVideoItemByJsonData(a);break;case"image":c=this.getImageItemByJsonData(a);break;default:return!1}return c},this.getSocialItemByJsonData=function(b){var c=a.getNew("social",this.getThisPlattformString());return $.extend(!0,c,{blog_name:b.user.full_name||"@"+b.user.username,blog_id:"@"+b.user.username,blog_link:this.getThisPlattformLink()+b.user.username,intern_type:b.type,timestamp:1e3*parseInt(b.created_time),post_url:b.link,intern_id:b.id,text:b.caption?b.caption.text:!1,likes:b.likes?b.likes.count:!1,comments:b.comments?b.likes.comments:!1}),c.date_time=new Date(c.timestamp),c.text=this.replaceHashtagWithoutSpaces(c.text),"video"==b.type&&(c.type="video",c.source=b.videos),c.img_url=b.images.standard_resolution.url,c},this.getVideoItemByJsonData=function(b){if("video"!=b.type)return!1;var c=a.getNew("video",this.getThisPlattformString());return $.extend(!0,c,{blog_name:b.user.full_name||"@"+b.user.username,blog_id:"@"+b.user.username,blog_link:this.getThisPlattformLink()+b.user.username,intern_type:b.type,timestamp:1e3*parseInt(b.created_time),post_url:b.link,intern_id:b.id,text:b.caption?b.caption.text:!1,likes:b.likes?b.likes.count:!1,comments:b.comments?b.likes.comments:!1,type:"video",source:b.videos.standard_resolution?b.videos.standard_resolution.url:!1}),c.date_time=new Date(c.timestamp),c.text=this.replaceHashtagWithoutSpaces(c.text),c.img_url=b.images.standard_resolution.url,c},this.getImageItemByJsonData=function(b){if("image"!=b.type)return!1;var c=a.getNew("image",this.getThisPlattformString());return $.extend(!0,c,{blog_name:b.user.full_name||"@"+b.user.username,blog_id:"@"+b.user.username,blog_link:this.getThisPlattformLink()+b.user.username,intern_type:b.type,timestamp:1e3*parseInt(b.created_time),post_url:b.link,intern_id:b.id,text:b.caption?b.caption.text:!1,likes:b.likes?b.likes.count:!1,comments:b.comments?b.likes.comments:!1,type:"image"}),c.date_time=new Date(c.timestamp),c.text=this.replaceHashtagWithoutSpaces(c.text),c.img_url=b.images.standard_resolution.url,c},this.replaceHashtagWithoutSpaces=function(a){return a&&"string"===$.type(a)&&(a=a.replace(/#/g," #"),a=a.replace(/  #/g," #")),a}}]),angular.module("jtt_instagram",[]).factory("instagramFactory",["$http","instagramSearchDataService",function(a,b){var c={};return c.getUserById=function(c){var d=b.getNew("userById",c);return a.jsonp(d.url,{method:"GET",params:d.object})},c.getMediaFromUserById=function(c){var d=b.getNew("mediaFromUserById",c);return a.jsonp(d.url,{method:"GET",params:d.object})},c.getMediaByTag=function(c){var d=b.getNew("mediaByTag",c);return a.jsonp(d.url,{method:"GET",params:d.object})},c.getMediaFromLocationById=function(c){var d=b.getNew("mediaFromLocationById",c);return a.jsonp(d.url,{method:"GET",params:d.object})},c.getMediaByCoordinates=function(c){var d=b.getNew("mediaByCoordinates",c);return a.jsonp(d.url,{method:"GET",params:d.object})},c}]).service("instagramSearchDataService",function(){this.getApiBaseUrl=function(a){return"https://api.instagram.com/v1/"},this.fillDataInObjectByList=function(a,b,c){return angular.forEach(c,function(c,d){"undefined"!=typeof b[c]&&(a.object[c]=b[c])}),a},this.getNew=function(a,b){var c={object:{},url:""};switch(c.object={access_token:b.access_token,callback:"JSON_CALLBACK"},a){case"userById":c.url=this.getApiBaseUrl()+"users/"+b.userId;break;case"mediaFromUserById":c.object.count=b.count||20,c=this.fillDataInObjectByList(c,b,["max_id","min_id","min_timestamp","max_timestamp"]),c.url=this.getApiBaseUrl()+"users/"+b.userId+"/media/recent";break;case"mediaByTag":c.object.count=b.count||20,c=this.fillDataInObjectByList(c,b,["max_tag_id","min_tag_id","min_timestamp","max_timestamp"]),c.url=this.getApiBaseUrl()+"tags/"+b.tag+"/media/recent";break;case"mediaFromLocationById":c.object.count=b.count||40,c=this.fillDataInObjectByList(c,b,["max_id","min_id","min_timestamp","max_timestamp"]),c.url=this.getApiBaseUrl()+"locations/"+b.locationId+"/media/recent";break;case"mediaByCoordinates":c.object.count=b.count||20,c=this.fillDataInObjectByList(c,b,["lat","lng","distance","min_timestamp","max_timestamp"]),c.url=this.getApiBaseUrl()+"media/search"}return c}});